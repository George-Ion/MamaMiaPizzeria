{% extends "layout.html" %}

{% block title %}Orders - Mamma Mia Pizza{% endblock %}

{% block content %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <h2>Orders</h2>
        <a class="btn" href="{{ url_for('products.show_menu') }}">New Order</a>
    </div>

    {% if orders %}
    <table>
        <thead>
            <tr>
                <th>Order ID</th>
                <th>Customer</th>
                <th>Status</th>
                <th>Total</th>
                <th>Date</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for order, customer, user in orders %}
            <tr>
                <td>#{{ order.order_id }}</td>
                <td>{{ user.first_name }} {{ user.last_name }}</td>
                <td>
                    <span class="status-{{ order.delivery_status.lower().replace(' ', '-') }}">
                        {% if order.delivery_status == 'Pending' %}Pending
                        {% elif order.delivery_status == 'In Progress' %}In Progress
                        {% elif order.delivery_status == 'Out for Delivery' %}Out for Delivery
                        {% elif order.delivery_status == 'Delivered' %}Delivered
                        {% elif order.delivery_status == 'Cancelled' %}Cancelled
                        {% endif %}
                    </span>
                </td>
                <td class="price">â‚¬{{ '%.2f'|format(order.final_total) }}</td>
                <td>{{ order.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>
                    <a href="{{ url_for('orders.order_detail', order_id=order.order_id) }}" class="btn">View</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
        <p>No orders yet.</p>
    {% endif %}
</div>

<style>
.status-pending {
    background: #ffd700;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.9em;
}
.status-in-progress {
    background: #00bcd4;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.9em;
}
.status-out-for-delivery {
    background: #2196f3;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.9em;
}
.status-delivered {
    background: #4caf50;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.9em;
}
.status-cancelled {
    background: #f44336;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.9em;
}
</style>
{% endblock %}
